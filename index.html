<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Envelope + Text Animation</title>
<style>
body {
  margin: 0;
  background-color: #000000;
  font-family: 'Pretendard', 'Noto Sans KR', sans-serif;
  transition: background-color 1.5s ease;
  overflow-x: hidden;
}

/* envelope 섹션 */
.hero {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  position: relative;
}

.envelope {
  position: relative;
  width: 300px;
  height: 200px;
  perspective: 800px;
  cursor: pointer;
}

.envelope-body {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  transform-origin: center center;
}

.envelope img {
  position: absolute;
  width: 100%;
  height: 100%;
  object-fit: contain;
  top: 0;
  left: 0;
  transition: transform 1s ease-in-out, z-index 0s linear 0s, opacity 1s ease-in-out;
}

/* 레이어 설정 */
.back { z-index: 1; }
.shadow-flap { z-index: 2; opacity: 0; transform-origin: top center; top: 0.5px; }
.letter { z-index: 3; }
.front { z-index: 5; }
.flap { z-index: 6; transform-origin: top center; top: 0.5px; }

/* 텍스트 섹션 */
.trigger-section {
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  text-align: center;
  min-height: 100vh;
  transform: translateY(-200px); /* PC 기준 위치 */
  opacity: 0;
  transition: opacity 1s ease;
}

.jungle-cont__title,
.jungle-cont__sub,
.jungle-cont__desc {
  opacity: 0;
  transform: translateY(40px);
  filter: blur(8px);
  transition: all 1s ease-out;
}

.show {
  opacity: 1;
  transform: translateY(0);
  filter: blur(0);
}

.jungle-cont__title,
.jungle-cont__sub { color: #c60000; }
.jungle-cont__desc { color: #000000; }

.jungle-cont__title { font-size: 1.4rem; font-weight: 700; margin-bottom: 1rem; }
.jungle-cont__sub { font-size: 1rem; margin-bottom: 1rem; }
.jungle-cont__desc { font-size: 0.9rem; line-height: 1.8; max-width: 800px; padding: 0 1rem; }

.trigger-active { opacity: 1; }

/* 모바일 전용 위치 조정 */
@media (max-width: 480px) {
  .envelope { width: 250px; height: 170px; }
  .trigger-section {
    transform: translateY(-260px); /* 모바일에서는 텍스트를 더 위로 올림 */
  }
}
</style>
</head>
<body>

<section class="hero">
  <div class="envelope">
    <div class="envelope-body">
      <img src="envelope-back.png" class="back" alt="봉투 뒷면">
      <img src="envelope-shadow-flap.png" class="shadow-flap" alt="뚜껑 그림자">
      <img src="envelope-front.png" class="front" alt="봉투 앞면">
      <img src="envelope-flap.png" class="flap" alt="봉투 뚜껑">
    </div>
    <img src="letter.png" class="letter" alt="편지">
  </div>
</section>

<section class="trigger-section" id="triggerSection">
  <div class="jungle-cont__copy">
    <p class="jungle-cont__title">당신을 초대합니다</p>
    <p class="jungle-cont__sub">조선대학교 시각디자인학과 75th 졸업전시회</p>
    <p class="jungle-cont__desc">
      빛과 색, 형태로 세상을 표현한 여러분의 여정에 박수를 보냅니다.<br>
      <span>수많은 고민과 시도가 모여 오늘의 전시를 만들었네요.<br>
      당신의 디자인이 앞으로도 세상에 새로운 시선을 더해주길 바랍니다.</span><br><br>
      <span>이 여정의 끝이 또 다른 시작이 되기를 응원합니다.<br>
      시각디자인학과 졸업전시회를 진심으로 축하드립니다!</span><br><br>
    </p>
  </div>
</section>

<script>
const envelope = document.querySelector('.envelope');
const envelopeBody = document.querySelector('.envelope-body');
const flap = document.querySelector('.flap');
const shadowFlap = document.querySelector('.shadow-flap');
const letter = document.querySelector('.letter');
const front = document.querySelector('.front');

const flapRotationDuration = 1000;
const letterUpDistance = -180;
const letterUpDuration = 1000;
const letterStayDuration = 200;
const letterDownDistance = 0;
const letterDownDuration = 1000;

const bodyRotateDegree = 10;
const bodyMoveRight = 40;
const bodyMoveUp = -10;
const bodyMoveDuration = 700;

const letterRotateDegree = -10;
const letterMoveLeft = 40;
const letterMoveDown = 50;
const letterRotateDuration = 800;

const bgTransitionDelay = 1500;
const textScrollDistance = 150;
const textScrollDuration = 1000;
const textStaggerDelay = 700;

const triggerSection = document.getElementById('triggerSection');
const textElements = document.querySelectorAll('.jungle-cont__title, .jungle-cont__sub, .jungle-cont__desc');

window.addEventListener('load', () => {
  setTimeout(() => {
    flap.style.transition = `transform ${flapRotationDuration}ms ease-in-out`;
    flap.style.transform = 'translateY(0.5px) rotateX(-180deg)';

    shadowFlap.style.transition = `transform ${flapRotationDuration}ms ease-in-out, opacity ${flapRotationDuration/2}ms ease-in-out`;
    shadowFlap.style.transform = 'translateY(0.5px) rotateX(-180deg)';
    shadowFlap.style.opacity = 1;

    setTimeout(() => {
      flap.style.zIndex = 2;
      shadowFlap.style.zIndex = 3;
      letter.style.zIndex = 4;
      letter.style.transition = `transform ${letterUpDuration}ms ease-in-out`;
      letter.style.transform = `translateY(${letterUpDistance}px)`;
    }, flapRotationDuration + 50);

    setTimeout(() => { letter.style.zIndex = 6; }, flapRotationDuration + 50 + letterUpDuration);

    setTimeout(() => {
      letter.style.transition = `transform ${letterRotateDuration}ms ease-in-out`;
      letter.style.transform = `translateX(-${letterMoveLeft}px) translateY(${letterDownDistance + letterMoveDown}px) rotate(${letterRotateDegree}deg)`;

      envelopeBody.style.transition = `transform ${bodyMoveDuration}ms ease-in-out`;
      envelopeBody.style.transform = `translateX(${bodyMoveRight}px) translateY(${bodyMoveUp}px) rotate(${bodyRotateDegree}deg)`;

      front.style.zIndex = 5;

      setTimeout(() => {
        document.body.style.backgroundColor = '#ffffff';
        triggerSection.classList.add('trigger-active');
        textElements.forEach((el, idx) => {
          setTimeout(() => { el.classList.add('show'); }, idx * textStaggerDelay);
        });
        smoothScrollBy(textScrollDistance, textScrollDuration);
      }, bgTransitionDelay);

    }, flapRotationDuration + 50 + letterUpDuration + letterStayDuration);
  }, 1500);
});

function smoothScrollBy(distance, duration) {
  const start = window.scrollY;
  const target = start + distance;
  const startTime = performance.now();

  function step(currentTime) {
    const elapsed = currentTime - startTime;
    const progress = Math.min(elapsed / duration, 1);
    const ease = 1 - Math.pow(1 - progress, 3);
    window.scrollTo(0, start + (target - start) * ease);
    if (progress < 1) requestAnimationFrame(step);
  }

  requestAnimationFrame(step);
}
</script>

</body>
</html>
